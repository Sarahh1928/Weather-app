import{a as Q,b as Z}from"./chunk-J44JLTDA.js";import{$ as J,A as f,E as R,H as s,I as V,J as p,K as I,L as A,N as B,O as Y,P as $,R as O,S as z,T as L,U as q,V as G,W as H,X as h,a as F,b as D,da as T,e as w,ea as K,f as S,fa as X,ga as ee,i as k,k as a,l as d,m as E,n as y,o as C,p as m,q as c,r as o,v as j,w as P,x as U,y as M}from"./chunk-KZV6RB4M.js";var x=class t{getWeekNumber(i){let e=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())),n=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-n);let r=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-r.getTime())/864e5+1)/7)}getWeekOffsetFromDate(i,e=new Date){let n=e.getDay()||7,r=new Date(e);r.setDate(e.getDate()-n+1);let l=i.getDay()||7,g=new Date(i);g.setDate(i.getDate()-l+1);let v=Math.floor((g.getTime()-r.getTime())/(1e3*60*60*24));return Math.floor(v/7)}generateWeekDates(i){let e=[],n=new Date;n.setDate(n.getDate()+i*7);for(let r=0;r<7;r++){let l=new Date(n);l.setDate(n.getDate()+r);let g=l.getFullYear(),v=String(l.getMonth()+1).padStart(2,"0"),b=String(l.getDate()).padStart(2,"0");e.push(`${g}-${v}-${b}`)}return e}static \u0275fac=function(e){return new(e||t)};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})};var re=t=>({color:t}),ae=(t,i)=>({"forecast-light":t,"forecast-dark":i}),oe=t=>({"selected-date":t});function ce(t,i){if(t&1&&(j(0),c(1,"div",14),s(2),o(),c(3,"div",15),s(4),o(),c(5,"div",16),s(6),o(),P()),t&2){let e=i.ngIf,n=f(3);a(2),p(" ",n.getIcon(e.temperatureCelsius,e.humidity)," "),a(2),p("\u{1F321}\uFE0F ",n.displayTemperature(e),"\xB0"),a(2),p("\u{1F4A7} ",e.humidity,"%")}}function se(t,i){t&1&&(c(0,"div",17),s(1,"No data yet"),o())}function me(t,i){if(t&1&&(c(0,"div",11)(1,"div",12),s(2),B(3,"date"),o(),C(4,ce,7,3,"ng-container",13)(5,se,2,0,"ng-template",null,0,$),o()),t&2){let e=i.$implicit,n=R(6),r=f(2);m("ngClass",I(7,oe,r.state.selectedDate()===e)),a(2),V(Y(3,4,e,"EEE, MMM d")),a(2),m("ngIf",r.forecastForDate(e))("ngIfElse",n)}}function de(t,i){if(t&1){let e=U();c(0,"div",3)(1,"h2",4),s(2),o(),c(3,"div",5)(4,"button",6),M("click",function(){w(e);let r=f();return S(r.prevWeek())}),s(5," \u25C0 Previous "),o(),c(6,"span",7),s(7),o(),c(8,"button",8),M("click",function(){w(e);let r=f();return S(r.nextWeek())}),s(9," Next \u25B6 "),o()(),c(10,"div",9),C(11,me,7,9,"div",10),o()()}if(t&2){let e,n=f();a(),m("ngStyle",I(6,re,n.themeService.themeMode()==="light"?"#0b3d91":"#1e3a8a")),a(),p("",(e=n.city())==null?null:e.city," Forecast"),a(2),m("disabled",n.weekOffset()===0),a(3),p("Week ",n.weekNumber()),a(3),m("ngClass",A(8,ae,n.themeService.themeMode()==="light",n.themeService.themeMode()==="dark")),a(),m("ngForOf",n.weekDates())}}function le(t,i){t&1&&(c(0,"div",18)(1,"p"),s(2,"Loading city details..."),o()())}var u=class t{constructor(i,e,n,r,l,g,v){this.route=i;this.weatherService=e;this.state=n;this.tempService=r;this.iconService=l;this.dateUtils=g;this.themeService=v;let b=Number(this.route.snapshot.paramMap.get("id"));this.weatherService.getCityById(b).subscribe({next:ie=>{this.city.set(ie);let N=this.state.selectedDate();N&&this.weekOffset.set(this.dateUtils.getWeekOffsetFromDate(new Date(N)))}})}city=k(null);weekOffset=k(0);weekNumber=O(()=>this.dateUtils.getWeekNumber(new Date(new Date().setDate(new Date().getDate()+this.weekOffset()))));weekDates=O(()=>this.dateUtils.generateWeekDates(this.weekOffset()));displayTemperature(i){return this.tempService.convert(i.temperatureCelsius,this.state.temperatureUnit())}getIcon(i,e){return this.iconService.getIcon(i,e)}forecastForDate(i){return this.city()?.forecast.find(e=>e.date===i)||null}nextWeek(){this.weekOffset.set(this.weekOffset()+1)}prevWeek(){this.weekOffset()>0&&this.weekOffset.set(this.weekOffset()-1)}static \u0275fac=function(e){return new(e||t)(d(J),d(Q),d(K),d(X),d(Z),d(x),d(ee))};static \u0275cmp=E({type:t,selectors:[["app-city-details-component"]],decls:2,vars:2,consts:[["noData",""],["class","city-details-container mt-4 p-4 rounded",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"city-details-container","mt-4","p-4","rounded"],[1,"mb-4","fw-bold",3,"ngStyle"],[1,"d-flex","justify-content-between","align-items-center","mb-3","flex-wrap"],[1,"btn","mb-2",3,"click","disabled"],[1,"mb-2"],[1,"btn","mb-2",3,"click"],[1,"weekly-forecast","d-flex","flex-wrap","gap-3","justify-content-start",3,"ngClass"],["class","forecast-card text-center",3,"ngClass",4,"ngFor","ngForOf"],[1,"forecast-card","text-center",3,"ngClass"],[1,"forecast-date","mb-2"],[4,"ngIf","ngIfElse"],[1,"forecast-icon","mb-2"],[1,"forecast-temp","mb-1"],[1,"forecast-humidity"],[1,"no-data"],[1,"mt-4"]],template:function(e,n){e&1&&C(0,de,12,11,"div",1)(1,le,3,0,"div",2),e&2&&(m("ngIf",n.city()),a(),m("ngIf",!n.city()))},dependencies:[h,z,L,q,G,H],styles:[".forecast-card[_ngcontent-%COMP%]{border-radius:16px;padding:10px;flex:1 1 calc(50% - 1rem);min-width:140px;max-width:200px;transition:transform .2s ease,box-shadow .2s ease;text-align:center}@media (min-width: 1200px){.forecast-card[_ngcontent-%COMP%]{flex:1 1 calc(14% - 1rem)}}.forecast-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 20px #0000321a}.forecast-light[_ngcontent-%COMP%]   .forecast-card[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#cce9ff,#f2f9ff)}.forecast-dark[_ngcontent-%COMP%]   .forecast-card[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#1a1a2e,#16213e)}.forecast-dark[_ngcontent-%COMP%]   .forecast-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 20px #ffffff1a}.forecast-icon[_ngcontent-%COMP%]{font-size:2rem}.forecast-date[_ngcontent-%COMP%]{font-weight:700}.selected-date[_ngcontent-%COMP%]{border:2px solid gold;box-shadow:0 0 10px #ffd700b3}"]})};var fe=[{path:"",component:u}],_=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=y({type:t});static \u0275inj=D({imports:[T.forChild(fe),T]})};var te=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=y({type:t});static \u0275inj=D({imports:[h,_,u]})};export{te as CityDetailsModule};
